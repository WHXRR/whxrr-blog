---
title: "reacté¢è¯•é¢˜"
outline: deep
desc: "reactç›¸å…³çš„é¢è¯•é¢˜"
tags: "react"
updateTime: "2025-07-01 10:33"
pic: https://cdn.pixabay.com/photo/2020/08/27/09/09/village-5521554_1280.jpg
picSize: 1280x929
---

## React18 æ–°ç‰¹æ€§

::: details æŸ¥çœ‹ç­”æ¡ˆ

1. è‡ªåŠ¨æ‰¹å¤„ç†ï¼ŒåŒä¸€ä¸ªäº‹ä»¶ä¸­å¤šä¸ª setState ä¼šè¢«åˆå¹¶

2. starTransitionï¼šå¯ä»¥ç”¨æ¥åŒ…è£¹ä¸æ˜¯å¾ˆé‡è¦çš„æ›´æ–°ï¼Œreact ä¼šå…ˆå¤„ç†å…¶ä»–é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡å†æ¥å¤„ç†è¿™é‡Œçš„æ›´æ–°

3. Suspense æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“

4. React.createRoot æ›¿æ¢ React.render

5. ä¸€äº›æ–° hookï¼šuseIdï¼ŒuseDeferredValueï¼ŒuseTransition

:::

## React æ€§èƒ½ä¼˜åŒ–

::: details æŸ¥çœ‹ç­”æ¡ˆ

- åˆç†åˆ©ç”¨ memo æ¥è§„é¿å­ç»„ä»¶ä¸å¿…è¦çš„æ¸²æŸ“

- åˆç†ä½¿ç”¨ useMemo å’Œ useCallback æ¥ç¼“å­˜è®¡ç®—ç»“æœå’Œå‡½æ•°

- ä½¿ç”¨ React.lazy å°†ç»„ä»¶æ‡’åŠ è½½

- ç®€åŒ– state ä¸­çš„æ•°æ®

- å‡å°‘ Context é¢‘ç¹æ›´æ–°

:::

## React çŠ¶æ€ç®¡ç†å™¨

::: details æŸ¥çœ‹ç­”æ¡ˆ

1. Redux

redux æ˜¯ react çš„ä¸€ä¸ªçŠ¶æ€ç®¡ç†å™¨ï¼Œä»–ä¸»è¦æœ‰ä¸‰ä¸ªéƒ¨åˆ†ã€‚ä¸€ä¸ªæ˜¯ storeï¼Œç”¨æ¥ä¿å­˜æ•´ä¸ªåº”ç”¨çš„çŠ¶æ€ã€‚ä¸€ä¸ªæ˜¯ actionï¼Œå°±æ˜¯ä¸€ä¸ª js å¯¹è±¡ï¼Œç”¨æ¥æè¿°ä½ è¦åšä»€ä¹ˆæ“ä½œã€‚è¿˜æœ‰ä¸€ä¸ªæ˜¯ reducerï¼Œå®ƒæ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ stateï¼Œä¸€ä¸ªæ˜¯ actionï¼Œä»–ä¼šæ ¹æ®ä¼ å…¥çš„ action çš„ type æ¥åšä¸åŒçš„æ“ä½œï¼Œè¿”å›æ–°çš„ stateã€‚

![redux](/notes/react/1.jpg)

![redux](/notes/react/2.jpg)

![redux](/notes/react/3.jpg)

2. Zustand

zustand ä¹Ÿæ˜¯ react çš„ä¸€ä¸ªçŠ¶æ€ç®¡ç†å™¨ï¼Œå®ƒæ¯” redux æ›´åŠ çš„è½»é‡çº§ï¼Œæ²¡æœ‰ redux ä¸­çš„ actionã€reducer é‚£ä¹ˆå¤šæ¦‚å¿µã€‚ä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œç›´æ¥ç”¨å‡½æ•°æ–¹å¼å£°æ˜å’Œè°ƒç”¨ã€‚

![zustand](/notes/react/4.jpg)

![zustand](/notes/react/5.jpg)

:::

## ç›¸å¯¹äºä¼ ç»Ÿ classï¼Œ Hooks æœ‰å“ªäº›ä¼˜åŠ¿?

::: details æŸ¥çœ‹ç­”æ¡ˆ

1. å†™æ³•æ›´ç®€å•ï¼Œè€Œä¸”æ²¡æœ‰ this çš„ç»‘å®šé—®é¢˜

2. å¯ä»¥è¿›è¡Œå°è£…ï¼Œæ›´å¥½çš„å¤ç”¨

:::

## å®ç° useTimeout hook

::: details æŸ¥çœ‹ç­”æ¡ˆ

```js
import { useEffect, useRef } from "react";

export function useTimeout(callback, delay) {
  const savedCallback = useRef();

  useEffect(() => {
    savedCallback.current = callback;
  }, [callback]);

  useEffect(() => {
    if (delay !== null) {
      const timer = setTimeout(() => {
        savedCallback.current();
      }, delay);
      return () => clearTimeout(timer);
    }
  }, [delay]);
}
```

:::

## setState æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Ÿ

::: details æŸ¥çœ‹ç­”æ¡ˆ

setState æœ¬èº«æ˜¯åŒæ­¥çš„ï¼Œåªæ˜¯å®ƒçš„çŠ¶æ€æ›´æ–°æ˜¯å¼‚æ­¥ç”Ÿæ•ˆçš„ã€‚å› ä¸º react ä¼šå¯¹æ›´æ–°åšæ‰¹å¤„ç†ä¼˜åŒ–ï¼Œå®ƒä¼šå¯¹å¤šæ¬¡ setState è¿›è¡Œåˆå¹¶ ï¼Œé¿å…é‡å¤æ¸²æŸ“ï¼Œæ‰€ä»¥ä¸èƒ½ç«‹åˆ»æ‹¿åˆ°æ›´æ–°åçš„ state ã€‚è€Œåœ¨ react18 ä¹‹å‰ï¼Œåªæœ‰åœ¨ react äº‹ä»¶å†…éƒ¨æ‰ä¼šåšæ‰¹å¤„ç†ï¼Œåœ¨ setTimeout æˆ–è€… åŸç”Ÿ dom äº‹ä»¶ä¸­ä¸ä¼šå¼€å¯ï¼Œæ‰€ä»¥å¯ä»¥ç«‹å³æ‹¿åˆ°æ›´æ–°åçš„å€¼ã€‚åœ¨ react18 ä¹‹åï¼Œå¼•å…¥äº†è‡ªåŠ¨æ‰¹å¤„ç†ï¼Œåœ¨å¼‚æ­¥åœºæ™¯ä¸‹ä¹Ÿä¼šè¿›è¡Œæ‰¹å¤„ç†äº†ã€‚

:::

## ä¸ºä»€ä¹ˆè¦æœ‰åˆæˆäº‹ä»¶ï¼Ÿ

::: details æŸ¥çœ‹ç­”æ¡ˆ

1. ä¸ºäº†å…¼å®¹å„ç§æµè§ˆå™¨

2. å¯ä»¥æå‡æ€§èƒ½ï¼Œå› ä¸º react ä¼šå°†æ‰€æœ‰äº‹ä»¶ç»‘å®šåˆ° document ä¸Šç»Ÿä¸€è¿›è¡Œç®¡ç†

3. ä¸ºäº†æ›´å¥½çš„æ§åˆ¶äº‹ä»¶è¡Œä¸ºï¼Œï¼Œæ¯”å¦‚å¯ä»¥æ‰¹å¤„ç†äº‹ä»¶çš„æ›´æ–°ï¼Œæ§åˆ¶äº‹ä»¶çš„ä¼˜å…ˆçº§

:::

## React ä¸­ï¼Œçˆ¶å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œé¡ºåº

::: details æŸ¥çœ‹ç­”æ¡ˆ

1. å‡½æ•°å¼ç»„ä»¶

```js
function Parent() {
  console.log("çˆ¶");
  useEffect(() => {
    console.log("ğŸ‘¨â€ğŸ‘¦ Parent mounted");
    return () => console.log("ğŸ‘¨â€ğŸ‘¦ Parent unmounted");
  }, []);

  return <Child />;
}

function Child() {
  console.log("å­");
  useEffect(() => {
    console.log("ğŸ‘¶ Child mounted");
    return () => console.log("ğŸ‘¶ Child unmounted");
  }, []);

  return <div>child</div>;
}

function App() {
  const [show, setShow] = useState(false);
  return (
    <div>
      <button onClick={() => setShow(!show)}>toggle</button>
      {show && <Parent />}
    </div>
  );
}
```

ä¸Šé¢çš„ä»£ç çš„æ‰“å°é¡ºåºæ˜¯

æŒ‚è½½æ—¶ï¼š

```
çˆ¶
å­
ğŸ‘¶ Child mounted
ğŸ‘¨â€ğŸ‘¦ Parent mounted
```

å¸è½½æ—¶ï¼š

```
ğŸ‘¨â€ğŸ‘¦ Parent unmounted
ğŸ‘¶ Child unmounted
```

2. ç±»ç»„ä»¶

```js
class Parent extends React.Component {
  constructor() {
    super();
    console.log("ğŸ‘¨â€ğŸ‘¦ Parent constructor");
  }

  componentDidMount() {
    console.log("ğŸ‘¨â€ğŸ‘¦ Parent didMount");
  }

  render() {
    return <Child />;
  }
}

class Child extends React.Component {
  constructor() {
    super();
    console.log("ğŸ‘¶ Child constructor");
  }

  componentDidMount() {
    console.log("ğŸ‘¶ Child didMount");
  }

  render() {
    return <div>child</div>;
  }
}
```

æŒ‚è½½æ—¶ï¼š

```
1. ğŸ‘¨â€ğŸ‘¦ Parent constructor
2. ğŸ‘¨â€ğŸ‘¦ Parent render
3. ğŸ‘¶ Child constructor
4. ğŸ‘¶ Child render
5. ğŸ‘¶ Child componentDidMount
6. ğŸ‘¨â€ğŸ‘¦ Parent componentDidMount
```

å¸è½½æ—¶ï¼š

```
1. ğŸ‘¶ Child componentWillUnmount
2. ğŸ‘¨â€ğŸ‘¦ Parent componentWillUnmount
```

:::

## React æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰åŸç†ï¼Ÿ

::: details æŸ¥çœ‹ç­”æ¡ˆ

æœåŠ¡ç«¯ä¼šæ ¹æ®å®¢æˆ·ç«¯è¯·æ±‚çš„è·¯å¾„ï¼Œæ‰¾åˆ°å¯¹åº”çš„ react è·¯ç”±ç»„ä»¶ï¼Œç„¶åé€šè¿‡å†…ç½®çš„ renderToString æ–¹æ³•å°†ç»„ä»¶æ¸²æŸ“æˆ html å­—ç¬¦ä¸²ï¼Œè¿”å›ç»™æµè§ˆå™¨ã€‚æµè§ˆå™¨æ‹¿åˆ°ä¹‹åä¼šè¿›è¡Œæ¸²æŸ“ï¼Œè¿˜æœ‰äº‹ä»¶çš„ç»‘å®šå’Œäº¤äº’ã€‚

:::

## useEffect å’Œ useLayoutEffect çš„åŒºåˆ«

::: details æŸ¥çœ‹ç­”æ¡ˆ
ä»–ä»¬çš„ä¸»è¦åŒºåˆ«æ˜¯æ‰§è¡Œæ—¶æœºä¸åŒï¼ŒuseLayoutEffect ä¼šåœ¨ dom æ›´æ–°å®Œæˆï¼Œæµè§ˆå™¨ç»˜åˆ¶ä¹‹å‰æ‰§è¡Œï¼Œåœ¨è¿™é‡Œåš dom çš„ä¿®æ”¹ï¼Œç”¨æˆ·æ˜¯æ„ŸçŸ¥ä¸åˆ°çš„ï¼Œè€Œä¸”ä»–æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œè¦é¿å…åšä¸€äº›è€—æ—¶è¿‡é•¿çš„äº‹æƒ…ã€‚

useEffect æ˜¯ç­‰æµè§ˆå™¨ç»˜åˆ¶å®Œæˆä¹‹åæ‰æ‰§è¡Œçš„ï¼Œå‡å¦‚åœ¨è¿™é‡Œä¿®æ”¹ dom çš„èƒŒæ™¯è‰²ä¼šå¯¼è‡´é¡µé¢é—ªçƒï¼Œä¸€èˆ¬ç”¨æ¥åšæ•°æ®è¯·æ±‚ï¼Œé€»è¾‘å¤„ç†ç­‰ä»»åŠ¡ã€‚
:::

## JSX çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ

::: details æŸ¥çœ‹ç­”æ¡ˆ

jsx æ˜¯ js çš„ä¸€ç§è¯­æ³•æ‰©å±•ï¼Œå®ƒèƒ½å¤Ÿåœ¨ js ä¸­ç¼–å†™ html çš„è¯­æ³•ã€‚éœ€è¦ç”¨ babel æ¥è½¬æˆ js ä»£ç ï¼Œç„¶åç”Ÿæˆ react å¯¹è±¡ã€‚

:::

## å¦‚ä½•ç†è§£ React Fiberï¼Ÿ

::: details æŸ¥çœ‹ç­”æ¡ˆ

react fiber æ˜¯ react ä¸ºäº†è§£å†³å¤§é‡ç»„ä»¶æ›´æ–°æ—¶ä¸»çº¿ç¨‹è¢«é•¿æ—¶é—´å ç”¨ï¼Œå¯¼è‡´é¡µé¢å¡é¡¿ã€æ‰å¸§çš„é—®é¢˜è€Œè®¾è®¡çš„ä¸€ç§æ–°æ¶æ„ã€‚

åœ¨è€ç‰ˆæœ¬ä¸­ï¼Œreact æ›´æ–°æ˜¯é€šè¿‡é€’å½’éå†ç»„ä»¶æ ‘æ¥å®Œæˆçš„ï¼Œä¸€æ—¦å¼€å§‹å°±æ— æ³•ä¸­æ–­ï¼Œå¦‚æœç»„ä»¶å±‚çº§è¿‡æ·±ï¼Œæ›´æ–°é¢‘ç¹å°±å®¹æ˜“é˜»å¡ä¸»çº¿ç¨‹ï¼Œå½±å“ç”¨æˆ·çš„äº¤äº’ã€‚

fiber çš„æ ¸å¿ƒæ€è·¯å°±æ˜¯æŠŠæ¸²æŸ“è¿‡ç¨‹æ‹†åˆ†ä¸ºå¾ˆå¤šå°ä»»åŠ¡ï¼Œç”¨é“¾è¡¨ç»“æ„æ¥æ›¿æ¢åŸæ¥çš„é€’å½’æ ˆç»“æ„ï¼Œè®©è¿™äº›ä»»åŠ¡å¯ä»¥æŒ‰éœ€ä¸­æ–­ã€æ¢å¤ï¼ŒæŒ‰ç…§ä¼˜å…ˆçº§è°ƒåº¦æ‰§è¡Œã€‚

è¡¥å……ï¼š

react ä¼šä¸ºæ¯ä¸ªç»„ä»¶åˆ›å»ºä¸€ä¸ª fiber èŠ‚ç‚¹ï¼Œé‡Œé¢è®°å½•äº†ç»„ä»¶ç±»å‹ã€ç»„ä»¶ propsã€stateã€å‰¯ä½œç”¨ã€ä¼˜å…ˆçº§ã€çˆ¶å­å…„å¼ŸèŠ‚ç‚¹ç­‰ä¿¡æ¯ã€‚

æ¸²æŸ“çš„æ—¶å€™ä¼šåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯ render é˜¶æ®µï¼š

ä¼šæ„å»ºæ–°çš„ fiber æ ‘ï¼Œå’Œæ—§æ ‘å¯¹æ¯”ï¼Œæ ‡è®°å“ªäº›èŠ‚ç‚¹éœ€è¦æ›´æ–°ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œå¯ä¸­æ–­ã€å¯æ¢å¤çš„ã€‚

å¯¹æ¯”è¿‡ç¨‹å¦‚ä¸‹ï¼š

- å¦‚æœç±»å‹å’Œ key ä¸€æ ·ï¼Œè¡¨ç¤ºå¯ä»¥å¤ç”¨

- å¦‚æœä¸åŒåˆ™é”€æ¯é‡å»º

- å¦‚æœæ—§èŠ‚ç‚¹æœ‰ï¼Œæ–°èŠ‚ç‚¹æ²¡æœ‰ï¼Œç›´æ¥åˆ é™¤æ—§èŠ‚ç‚¹

- å¦‚æœæ—§èŠ‚ç‚¹æ²¡æœ‰ï¼Œæ–°èŠ‚ç‚¹æœ‰ï¼Œæ–°å¢èŠ‚ç‚¹

ç¬¬äºŒä¸ªæ˜¯ Commit é˜¶æ®µï¼š

react ä¼šå°†å˜æ›´åº”ç”¨åˆ°çœŸå® dom ä¸Šï¼Œç„¶åæ‰§è¡Œå‰¯ä½œç”¨ï¼Œè¿™ä¸ªé˜¶æ®µæ˜¯åŒæ­¥çš„ï¼Œä¸å¯ä¸­æ–­çš„ã€‚

:::

## React çš„ diff ç®—æ³•

::: details æŸ¥çœ‹ç­”æ¡ˆ

React çš„ diff ç®—æ³•æ˜¯ç”¨æ¥æ¯”è¾ƒæ–°æ—§è™šæ‹Ÿ DOM çš„å·®å¼‚çš„ï¼Œç”¨æœ€å°‘çš„æ“ä½œæ­¥éª¤å»é«˜æ•ˆçš„æ›´æ–°çœŸå® domã€‚

å®ƒæœ‰å‡ ä¸ªç­–ç•¥ï¼š

1. åªè¿›è¡ŒåŒå±‚æ¯”è¾ƒ

2. èŠ‚ç‚¹ç±»å‹ä¸åŒç›´æ¥é”€æ¯é‡å»º

3. èŠ‚ç‚¹ç±»å‹ç›¸åŒï¼Œåˆ™å°è¯•å¤ç”¨å¹¶ç»§ç»­é€’å½’å±æ€§å’Œå­èŠ‚ç‚¹

4. å¤šä¸ªå­èŠ‚ç‚¹æ—¶ç”¨ key æ¥è¾…åŠ©æ¯”è¾ƒ

:::

## ä¸ºä½• React JSX å¾ªç¯éœ€è¦ä½¿ç”¨ key ï¼Ÿ

::: details æŸ¥çœ‹ç­”æ¡ˆ

react é€šè¿‡ key æ¥å¯¹æ¯ä¸ªå…ƒç´ åšå”¯ä¸€æ ‡è¯†ï¼Œå¯ä»¥ç”¨æ¥å¿«é€Ÿåˆ¤æ–­å“ªä¸ªèŠ‚ç‚¹è¯¥å¤ç”¨ã€å“ªä¸ªè¯¥é‡å»ºã€‚

è¿˜èƒ½å¤Ÿé¿å…çŠ¶æ€æ··ä¹±ï¼Œå¦‚æœåˆ—è¡¨é¡¹æ˜¯è¾“å…¥æ¡†æˆ–è€…å…¶ä»–æœ‰çŠ¶æ€çš„ç»„ä»¶ï¼Œé”™è¯¯çš„ key ä¼šå¯¼è‡´ç»„ä»¶ä¸é”™è¯¯çš„å†…å®¹è¿›è¡Œç»‘å®šï¼Œå¯¼è‡´é¡µé¢æ¸²æŸ“é”™è¯¯ã€‚

:::

## React äº‹ä»¶å’Œ DOM äº‹ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

::: details æŸ¥çœ‹ç­”æ¡ˆ

1. äº‹ä»¶åç§°ä¸ä¸€æ ·ï¼ŒåŸç”Ÿçš„äº‹ä»¶å…¨å°å†™ï¼Œreact çš„æ˜¯å°é©¼å³°å‘½åã€‚

2. äº‹ä»¶å¯¹è±¡ä¸ä¸€æ ·ï¼Œreact çš„åˆæˆäº‹ä»¶å¯¹åŸç”Ÿçš„äº‹ä»¶å¯¹è±¡è¿›è¡Œäº†ä¸€å±‚åŒ…è£…ï¼Œå¯ä»¥é€šè¿‡ e.nativeEvent è·å–åŸç”Ÿäº‹ä»¶å¯¹è±¡ã€‚

3. react äº‹ä»¶ç»‘å®šåˆ° document ä¸Šï¼Œé€šè¿‡äº‹ä»¶å§”æ‰˜æ¥å¤„ç†

:::

## ä¸ºä½• React Hooks ä¸èƒ½æ”¾åœ¨æ¡ä»¶æˆ–å¾ªç¯ä¹‹å†…ï¼Ÿ

::: details æŸ¥çœ‹ç­”æ¡ˆ

å› ä¸º react æ˜¯é è°ƒç”¨é¡ºåºæ¥åˆ¤æ–­æ¯ä¸ª hook çš„ä½ç½®çš„ã€‚å¦‚æœæ”¾åœ¨ if åˆ¤æ–­ä¸­ï¼Œè°ƒç”¨é¡ºåºå°±å¯èƒ½ä¸ä¸€è‡´ï¼Œæ¸²æŸ“çš„æ—¶å€™å°±æ— æ³•æ­£ç¡®åŒ¹é…å¯¹åº”çš„ hookï¼Œå¯¼è‡´æŠ¥é”™ã€‚

:::

## React çš„ç”Ÿå‘½å‘¨æœŸ

::: details æŸ¥çœ‹ç­”æ¡ˆ

react çš„ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºä¸¤ä¸ªç‰ˆæœ¬ã€‚

åœ¨ 16.3 ä¹‹å‰ï¼Œreact çš„ç”Ÿå‘½å‘¨æœŸä¸€èˆ¬åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼šæŒ‚è½½é˜¶æ®µã€æ›´æ–°é˜¶æ®µã€å¸è½½é˜¶æ®µ

- æŒ‚è½½é˜¶æ®µåŒ…æ‹¬ï¼š

  constructorï¼š æ‰§è¡Œåˆå§‹åŒ–æ“ä½œ

  componentWillMountï¼šå³å°†æŒ‚è½½æ—¶è§¦å‘

  render

  componentDidMount

- æ›´æ–°é˜¶æ®µï¼š

  componentWillReceivePropsï¼šçˆ¶ç»„ä»¶ä¼ é€’çš„å±æ€§æœ‰å˜åŒ–æ—¶è§¦å‘

  shouldComponentUpdateï¼šé€šè¿‡è¿”å›å¸ƒå°”å€¼æ¥æ§åˆ¶ç»„ä»¶æ˜¯å¦æ›´æ–°

  componentWillUpdateï¼šå³å°†æ›´æ–°æ—¶è§¦å‘

  render

  componentDidUpdate

- å¸è½½é˜¶æ®µï¼š

  componentWillUnMount

åœ¨ 16.3 ä¹‹åå¼•å…¥äº†æ–°çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼š

- æŒ‚è½½é˜¶æ®µï¼š

  constructor

  getDerivedStateFromPropsï¼šå½“ props æ”¹å˜æ—¶ï¼Œæ›´æ–° stateï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ–°çš„ propsï¼Œç¬¬äºŒä¸ªæ˜¯ stateï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ state æˆ–è€… null è¡¨ç¤ºä¸å˜

  render

  componentDidMount

- æ›´æ–°é˜¶æ®µï¼š

  getDerivedStateFromProps

  shouldComponentUpdate

  render

  getSnapshotBeforeUpdateï¼šå¯ä»¥åœ¨ dom æ›´æ–°å‰è®°å½•çŠ¶æ€ï¼Œæ¯”å¦‚æ»šåŠ¨æ¡ä½ç½®

  componentDidUpdate

- å¸è½½é˜¶æ®µï¼š

  componentWillUnmount

ä¹Ÿå¯ä»¥é€šè¿‡ useEffect è¿›è¡Œæ¨¡æ‹Ÿï¼š

```js
useEffect(() => {
  console.log("componentDidMount");
}, []);

useEffect(() => {
  console.log("componentDidUpdate");
}, [deps]);

useEffect(() => {
  return () => {
    console.log("componentWillUnmount");
  };
}, []);
```

:::

## æœ‰è‡ªå·±å®ç°è¿‡ hooks å—ï¼Ÿ

::: details æŸ¥çœ‹ç­”æ¡ˆ

æœ‰è‡ªå·±å®ç°è¿‡ï¼Œæ¯”å¦‚æœ‰è‡ªå·±å†™è¿‡ä¸€ä¸ªä¸‹æ‹‰æ¡†ç»„ä»¶ï¼Œå½“ç‚¹å‡»ä¸‹æ‹‰æ¡†ä¹‹å¤–çš„å…ƒç´ æ—¶è¦å°†ä¸‹æ‹‰æ¡†å…³é—­ï¼Œæˆ‘å°±å†™äº†ä¸€ä¸ª hook æ¥å®ç°çš„ã€‚

é¦–å…ˆè¿™ä¸ª hooks è¦ä¼ ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ä½ ç›®æ ‡å…ƒç´ ï¼Œæˆ‘è¿™é‡Œæ˜¯è¿™ä¸ªä¸‹æ‹‰æ¡†ï¼Œä¸€ä¸ªæ˜¯è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚

é€šè¿‡ useRef æ‹¿åˆ°ä¸‹æ‹‰æ¡†çš„ dom å…ƒç´ ï¼Œå›è°ƒå‡½æ•°å°±æ‰§è¡Œå…³é—­ä¸‹æ‹‰æ¡†ã€‚hooks é‡Œé¢é€šè¿‡ useEffect æ¥ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼Œå½“ ref æ²¡å€¼æˆ–è€… ref ä¸åŒ…å«ç‚¹å‡»çš„å…ƒç´ æ—¶ï¼Œç›´æ¥è¿”å›ï¼Œå…¶ä»–æƒ…å†µå°±æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚ç„¶ååœ¨ useEffect çš„è¿”å›å‡½æ•°ä¸­å°†ç‚¹å‡»äº‹ä»¶æ¸…é™¤ã€‚

```js
function useOnClickOutside(ref, cb) {
  useEffect(() => {
    function listener(e) {
      if (!ref.current || ref.current.contains(e.target)) return;
      cb();
    }

    document.addEventListener("click", listener);
    return () => document.removeEventListener("click", listener);
  }, [ref, cb]);
}
```

:::
